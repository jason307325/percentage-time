<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>COACH TECH 2026 (Ëß∏ÊéßÂÑ™ÂåñÁâà)</title>
<style>
    :root { 
        --primary: #004aad; --bg: #f2f4f8; --key-bg: #ffffff; 
        --highlight: #fff9c4; --multi: #34c759; --danger: #ff3b30; 
        --text: #333; --morandi-gray: #a6abb4;
    }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body { 
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
        background: var(--bg); margin: 0; padding: 0; height: 100dvh; width: 100vw; 
        display: flex; flex-direction: column; overflow: hidden; 
        padding-top: calc(env(safe-area-inset-top) + 5px); 
    }
    .container { flex: 1; padding: 2px 15px; display: flex; flex-direction: column; max-width: 420px; margin: auto; width: 100%; overflow: hidden; }
    h1 { text-align: center; margin: 0 0 5px 0; font-size: 13px; color: #999; letter-spacing: 1px; }
    
    /* Ê®°ÂºèÂàáÊèõ */
    .mode-switch { display: flex; gap: 5px; margin-bottom: 8px; flex-shrink: 0; }
    .mode-switch button { flex: 1; padding: 10px 2px; border: none; border-radius: 10px; background: #ddd; font-weight: bold; font-size: 13px; cursor: pointer; transition: 0.2s; color: #666; }
    .mode-switch button.active { background: var(--primary); color: #fff; box-shadow: 0 4px 10px rgba(0,74,173,0.3); }
    .mode-switch button.active.multi-btn { background: var(--multi); box-shadow: 0 4px 10px rgba(52,199,89,0.3); }

    /* ÊôÇÈñìÈ°ØÁ§∫ÂçÄÂüü */
    .time-display { display: flex; align-items: center; justify-content: center; gap: 6px; background: #fff; padding: 10px; border-radius: 14px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin-bottom: 8px; flex-shrink: 0; }
    .unit-box { flex: 1; text-align: center; border: 2.5px solid #eee; border-radius: 10px; padding: 6px 0; font-size: 24px; font-weight: 800; color: #333; position: relative; }
    .unit-box.active { border-color: var(--primary); background: #f0f7ff; color: var(--primary); }
    .unit-box span { font-size: 10px; display: block; color: #999; margin-top: -2px; }
    .sep { font-size: 20px; font-weight: bold; color: #ccc; }

    /* ÂêÑÁ®Æ View ÂçÄÂüü */
    .view-area { flex: 1; overflow: hidden; display: flex; flex-direction: column; }
    #athleteView, #coachView, #multiView { width: 100%; height: 100%; display: none; flex-direction: column; }

    /* ÊªëÊ°øÊ®£Âºè */
    .range-wrapper { position: relative; width: 100%; height: 50px; background: #ddd; border-radius: 25px; display: flex; align-items: center; padding: 0 4px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); touch-action: none; margin: 10px 0; }
    input[type=range] { width: 100%; height: 100%; -webkit-appearance: none; background: transparent; z-index: 3; position: relative; cursor: pointer; }
    input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 90px; height: 42px; background: var(--primary); border-radius: 21px; border: 3px solid #fff; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
    .multi-range::-webkit-slider-thumb { background: var(--multi); width: 80px; height: 34px; }
    
    .bubble { position: absolute; pointer-events: none; top: 50%; transform: translate(-50%, -50%); z-index: 4; color: #fff; font-weight: 900; font-size: 20px; text-align: center; }

    /* ÈÅ∏ÊâãÁâà */
    #athleteView { justify-content: center; gap: 15px; }
    .result { background: var(--primary); padding: 20px 10px; border-radius: 20px; text-align: center; font-size: 48px; font-weight: 900; color: #fff; font-family: monospace; }

    /* ÊïôÁ∑¥ÁâàË°®Ê†º */
    #coachView { overflow-y: auto; background: #fff; border-radius: 14px; }
    table { width: 100%; border-collapse: collapse; }
    th { padding: 10px; background: #f8f9fa; font-size: 12px; color: #666; position: sticky; top: 0; }
    td { padding: 10px 5px; text-align: center; border-bottom: 1px solid #f0f0f0; }
    .td-int { font-weight: bold; color: #666; }
    .td-res { font-size: 24px; font-weight: 900; color: var(--primary); font-family: monospace; }

    /* Â§ö‰∫∫Ê®°Âºè */
    .multi-btn-row { display: flex; gap: 5px; margin-bottom: 8px; flex-shrink: 0; }
    .add-btn { flex: 2; padding: 12px; border: 2px solid var(--multi); border-radius: 12px; background: #fff; color: var(--multi); font-weight: bold; cursor: pointer; }
    .clear-btn { flex: 1; padding: 12px; border: 2px solid var(--danger); border-radius: 12px; background: #fff; color: var(--danger); font-weight: bold; cursor: pointer; }
    #multiCardsArea { flex: 1; overflow-y: auto; }
    .multi-card { background: #fff; border-radius: 14px; padding: 12px; border-left: 6px solid var(--multi); box-shadow: 0 2px 5px rgba(0,0,0,0.06); display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; }
    .multi-res { font-size: 28px; font-weight: 900; color: var(--multi); font-family: monospace; }
    .del-btn { background: var(--danger); color: #fff; border: none; width: 35px; height: 35px; border-radius: 10px; font-size: 18px; font-weight: bold; }

    /* Êï∏Â≠óÈçµÁõ§ÁΩÆÂ∫ï */
    .numpad-wrapper { background: #d1d4d9; padding: 8px 8px calc(env(safe-area-inset-bottom) + 5px) 8px; flex-shrink: 0; }
    .numpad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; max-width: 400px; margin: 0 auto; }
    .key { background: var(--key-bg); height: 55px; display: flex; justify-content: center; align-items: center; font-size: 24px; font-weight: 600; border-radius: 10px; box-shadow: 0 1px 2px rgba(0,0,0,0.2); cursor: pointer; transition: 0.1s; color: var(--text); }
    .key:active { background: #e0e0e0; transform: scale(0.95); }
    .key.gray { background: var(--morandi-gray); color: #fff; }
</style>
</head>
<body>
<div class="container">
    <h1>COACH TECH 2026</h1>
    <div class="mode-switch">
        <button id="athleteBtn" class="active">ÈÅ∏ÊâãÁâà</button>
        <button id="coachBtn">ÊïôÁ∑¥Áâà</button>
        <button id="multiBtn" class="multi-btn">Â§ö‰∫∫Ê®°Âºè</button>
    </div>
    
    <div class="time-display">
        <div id="box-0" class="unit-box active" onclick="focusBox(0)">00<span>ÂàÜ</span></div>
        <div class="sep">:</div>
        <div id="box-1" class="unit-box" onclick="focusBox(1)">00<span>Áßí</span></div>
        <div class="sep">.</div>
        <div id="box-2" class="unit-box" onclick="focusBox(2)">00<span>ÊØ´Áßí</span></div>
    </div>

    <div class="view-area">
        <!-- ÈÅ∏ÊâãÁâà -->
        <div id="athleteView" style="display:flex">
            <div class="range-wrapper">
                <div class="bubble" id="athleteBubble">100%</div>
                <input type="range" id="mainRange" min="50" max="110" step="1" value="100">
            </div>
            <div id="resText" class="result">00:00.00</div>
        </div>

        <!-- ÊïôÁ∑¥Áâà -->
        <div id="coachView">
            <table>
                <thead><tr><th width="30%">Âº∑Â∫¶</th><th>ÊèõÁÆóÊàêÁ∏æ (2-10%)</th></tr></thead>
                <tbody id="coachTable"></tbody>
            </table>
        </div>

        <!-- Â§ö‰∫∫Ê®°Âºè -->
        <div id="multiView">
            <div class="multi-btn-row">
                <button class="add-btn" onclick="addNewAthlete()">Ôºã Êñ∞Â¢ûÈÅ∏ÊâãÁ¥ÄÈåÑ</button>
                <button class="clear-btn" onclick="clearAllData()">üóë Ê∏ÖÁ©∫</button>
            </div>
            <div class="range-wrapper" style="height: 44px;">
                <div class="bubble" id="multiBubble" style="font-size:16px;">100%</div>
                <input type="range" class="multi-range" id="mRange" min="50" max="110" step="1" value="100">
            </div>
            <div id="multiCardsArea">
                <div id="multiCardsList"></div>
            </div>
        </div>
    </div>
</div>

<div class="numpad-wrapper">
    <div class="numpad">
        <div class="key" onclick="press(7)">7</div><div class="key" onclick="press(8)">8</div><div class="key" onclick="press(9)">9</div>
        <div class="key" onclick="press(4)">4</div><div class="key" onclick="press(5)">5</div><div class="key" onclick="press(6)">6</div>
        <div class="key" onclick="press(1)">1</div><div class="key" onclick="press(2)">2</div><div class="key" onclick="press(3)">3</div>
        <div class="key gray" onclick="press('C')">C</div><div class="key" onclick="press(0)">0</div><div class="key gray" onclick="press('X')">‚å´</div>
    </div>
</div>

<script>
    let currentBox = 0;
    let timeParts = ["00", "00", "00"];
    let isFirstDigit = true;
    let athletes = [];

    // ÂàáÊèõÈ†ÅÈù¢
    const views = ['athleteView', 'coachView', 'multiView'];
    const btns = ['athleteBtn', 'coachBtn', 'multiBtn'];

    btns.forEach((id, idx) => {
        document.getElementById(id).addEventListener('click', () => {
            btns.forEach(b => document.getElementById(b).classList.remove('active'));
            document.getElementById(id).classList.add('active');
            views.forEach(v => document.getElementById(v).style.display = 'none');
            document.getElementById(views[idx]).style.display = (idx === 0) ? 'flex' : 'flex'; 
            if(idx === 1) renderCoachTable();
            if(idx === 2) renderMultiCards();
        });
    });

    function focusBox(idx) {
        currentBox = idx;
        isFirstDigit = true;
        document.querySelectorAll('.unit-box').forEach(b => b.classList.remove('active'));
        document.getElementById(`box-${idx}`).classList.add('active');
    }

    function press(key) {
        if (key === 'C') {
            timeParts = ["00", "00", "00"];
            isFirstDigit = true;
            currentBox = 0;
        } else if (key === 'X') {
            timeParts[currentBox] = "00";
            isFirstDigit = true;
        } else {
            let val = timeParts[currentBox];
            if (isFirstDigit) {
                val = "0" + key;
                isFirstDigit = false;
            } else {
                val = val.charAt(1) + key;
                isFirstDigit = true;
                if (currentBox < 2) focusBox(currentBox + 1);
            }
            timeParts[currentBox] = val;
        }
        updateDisplay();
    }

    function updateDisplay() {
        timeParts.forEach((val, idx) => {
            document.getElementById(`box-${idx}`).childNodes[0].nodeValue = val;
        });
        calculateAthlete();
    }

    function getBaseSeconds() {
        return parseInt(timeParts[0]) * 60 + parseInt(timeParts[1]) + parseInt(timeParts[2]) / 100;
    }

    function formatTime(totalSeconds) {
        if (!totalSeconds || totalSeconds === Infinity) return "00:00.00";
        let m = Math.floor(totalSeconds / 60);
        let s = Math.floor(totalSeconds % 60);
        let ms = Math.round((totalSeconds % 1) * 100);
        return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}.${String(ms).padStart(2,'0')}`;
    }

    // ÈÅ∏ÊâãÁâàÈÇèËºØ
    const mainRange = document.getElementById('mainRange');
    const athleteBubble = document.getElementById('athleteBubble');
    mainRange.oninput = () => {
        let val = mainRange.value;
        athleteBubble.innerText = val + "%";
        athleteBubble.style.left = `calc(${((val - 50) / 60) * 100}% )`;
        calculateAthlete();
    };

    function calculateAthlete() {
        let base = getBaseSeconds();
        let percent = mainRange.value / 100;
        document.getElementById('resText').innerText = formatTime(base / percent);
    }

    // ÊïôÁ∑¥ÁâàÈÇèËºØ
    function renderCoachTable() {
        let base = getBaseSeconds();
        let html = "";
        for (let i = 110; i >= 50; i -= 2) {
            html += `<tr>
                <td class="td-int">${i}%</td>
                <td class="td-res">${formatTime(base / (i / 100))}</td>
            </tr>`;
        }
        document.getElementById('coachTable').innerHTML = html;
    }

    // Â§ö‰∫∫Ê®°ÂºèÈÇèËºØ
    const mRange = document.getElementById('mRange');
    const multiBubble = document.getElementById('multiBubble');
    mRange.oninput = () => {
        multiBubble.innerText = mRange.value + "%";
        multiBubble.style.left = `calc(${((mRange.value - 50) / 60) * 100}% )`;
        renderMultiCards();
    };

    function addNewAthlete() {
        let base = getBaseSeconds();
        if (base <= 0) return;
        athletes.push(base);
        renderMultiCards();
    }

    function clearAllData() {
        if(confirm("Á¢∫ÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÁ¥ÄÈåÑÂóéÔºü")) {
            athletes = [];
            renderMultiCards();
        }
    }

    function renderMultiCards() {
        let percent = mRange.value / 100;
        let html = "";
        athletes.forEach((base, idx) => {
            html += `<div class="multi-card">
                <div>
                    <div style="font-size:10px; color:#999">ÈÅ∏Êâã ${idx+1} (${mRange.value}%)</div>
                    <div class="multi-res">${formatTime(base / percent)}</div>
                </div>
                <button class="del-btn" onclick="deleteAthlete(${idx})">√ó</button>
            </div>`;
        });
        document.getElementById('multiCardsList').innerHTML = html;
    }

    function deleteAthlete(idx) {
        athletes.splice(idx, 1);
        renderMultiCards();
    }

    // ÂàùÂßãÂåñÊ∞£Ê≥°‰ΩçÁΩÆ
    window.onload = () => {
        mainRange.oninput();
        mRange.oninput();
    };
</script>
</body>
</html>
